import { Meta } from '@storybook/addon-docs/blocks';

<Meta title="Design System/Interaction Patterns" />

# Interaction Patterns & States

Complete reference for all UI interaction patterns and component states.

---

## Hover States

### Card Hover

⚠️ **Note**: Hex uses VERY subtle shadows - much lighter than typical design systems!

Cards should lift on hover with a subtle shadow transition:

```css
.card {
  /* Hex default shadow - VERY subtle! */
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  transition: box-shadow 200ms ease-in-out;
}

.card:hover {
  /* Hover shadow - still subtle */
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.06);
}
```

**Example:**

<div className="p-4 bg-gray-50 rounded-lg">
  <div className="p-6 bg-white rounded-lg shadow transition-shadow hover:shadow-md cursor-pointer max-w-sm">
    <h4 className="font-semibold text-gray-900 mb-2">Connection Card</h4>
    <p className="text-sm text-gray-600">Hover to see shadow lift effect</p>
  </div>
</div>

### Button Hover

Primary buttons use gradient transitions:

```css
/* Base state */
background: linear-gradient(to right, #4B7FFF, #3366FF);
transition: background-color 200ms ease-in-out;

/* Hover state */
background: linear-gradient(to right, #3366FF, #2952CC);
```

**Example:**

<div className="p-4 bg-gray-50 rounded-lg">
  <button className="px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-md transition-all">
    Hover Me
  </button>
</div>

### Link Hover

Links transition from blue-500 to blue-600:

```css
color: #4B7FFF; /* blue-500 */
text-decoration: none;
transition: color 150ms ease-in-out;

/* On Hover */
color: #3366FF; /* blue-600 */
```

**Example:**

<div className="p-4 bg-gray-50 rounded-lg">
  <a href="#" className="text-blue-500 hover:text-blue-600 transition-colors">
    Click this link
  </a>
</div>

### Table Row Hover

Table rows highlight with subtle gray background:

```css
background: transparent;
transition: background-color 150ms ease-in-out;

/* On Hover */
background: #F9FAFB; /* gray-50 */
```

---

## Loading States

### Skeleton Loaders

Animated shimmer effect for loading content:

```css
.skeleton {
  background: linear-gradient(
    90deg,
    #F3F4F6 0%,
    #E5E7EB 50%,
    #F3F4F6 100%
  );
  background-size: 200% 100%;
  animation: shimmer 1.5s infinite;
}

@keyframes shimmer {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}
```

**Example:**

<div className="p-4 bg-gray-50 rounded-lg space-y-3">
  <div className="h-4 bg-gradient-to-r from-gray-100 via-gray-200 to-gray-100 rounded animate-pulse bg-[length:200%_100%]"></div>
  <div className="h-4 bg-gradient-to-r from-gray-100 via-gray-200 to-gray-100 rounded animate-pulse bg-[length:200%_100%] w-3/4"></div>
  <div className="h-4 bg-gradient-to-r from-gray-100 via-gray-200 to-gray-100 rounded animate-pulse bg-[length:200%_100%] w-1/2"></div>
</div>

### Spinner

Rotating border spinner:

```css
.spinner {
  border: 2px solid #E5E7EB; /* gray-200 */
  border-top-color: #4B7FFF; /* blue-500 */
  border-radius: 50%;
  width: 24px;
  height: 24px;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}
```

**Example:**

<div className="p-4 bg-gray-50 rounded-lg">
  <div className="w-6 h-6 border-2 border-gray-200 border-t-blue-500 rounded-full animate-spin"></div>
</div>

### Streaming Indicator

Blinking cursor for AI responses:

```css
.streaming-cursor {
  display: inline-block;
  width: 2px;
  height: 1.2em;
  background: #4B7FFF;
  margin-left: 2px;
  animation: blink 1s steps(2) infinite;
}

@keyframes blink {
  50% { opacity: 0; }
}
```

**Example:**

<div className="p-4 bg-gray-50 rounded-lg">
  <p className="text-sm text-gray-900">
    AI is typing
    <span className="inline-block w-0.5 h-4 bg-blue-500 ml-1 animate-pulse"></span>
  </p>
</div>

### "Thinking..." Dotted Animation

Verified from Fall 2025 Agents Threads interface - three rows of animated dots:

```tsx
<div className="flex items-center gap-1.5">
  <span className="text-gray-800 font-normal">Thinking.</span>
  <div className="flex flex-col gap-1">
    <div className="flex gap-1">
      <div className="w-1 h-1 rounded-full bg-gray-300 animate-pulse" style={{ animationDelay: '0ms' }}></div>
      <div className="w-1 h-1 rounded-full bg-gray-300 animate-pulse" style={{ animationDelay: '150ms' }}></div>
      <div className="w-1 h-1 rounded-full bg-gray-300 animate-pulse" style={{ animationDelay: '300ms' }}></div>
    </div>
    <div className="flex gap-1">
      <div className="w-1 h-1 rounded-full bg-gray-300 animate-pulse" style={{ animationDelay: '450ms' }}></div>
      <div className="w-1 h-1 rounded-full bg-gray-300 animate-pulse" style={{ animationDelay: '600ms' }}></div>
      <div className="w-1 h-1 rounded-full bg-gray-300 animate-pulse" style={{ animationDelay: '750ms' }}></div>
    </div>
    <div className="flex gap-1">
      <div className="w-1 h-1 rounded-full bg-gray-300 animate-pulse" style={{ animationDelay: '900ms' }}></div>
      <div className="w-1 h-1 rounded-full bg-gray-300 animate-pulse" style={{ animationDelay: '1050ms' }}></div>
      <div className="w-1 h-1 rounded-full bg-gray-300 animate-pulse" style={{ animationDelay: '1200ms' }}></div>
    </div>
  </div>
</div>
```

**Colors:**
- Text: `#1F2937` (gray-800)
- Dots: `#D1D5DB` (gray-300)
- Dot size: 4-6px

**Example:**

<div className="p-4 bg-gray-50 rounded-lg">
  <div className="flex items-center gap-1.5">
    <span className="text-gray-800 font-normal">Thinking.</span>
    <div className="flex flex-col gap-1">
      <div className="flex gap-1">
        <div className="w-1.5 h-1.5 rounded-full bg-gray-300 animate-pulse"></div>
        <div className="w-1.5 h-1.5 rounded-full bg-gray-300 animate-pulse" style={{ animationDelay: '150ms' }}></div>
        <div className="w-1.5 h-1.5 rounded-full bg-gray-300 animate-pulse" style={{ animationDelay: '300ms' }}></div>
      </div>
      <div className="flex gap-1">
        <div className="w-1.5 h-1.5 rounded-full bg-gray-300 animate-pulse" style={{ animationDelay: '450ms' }}></div>
        <div className="w-1.5 h-1.5 rounded-full bg-gray-300 animate-pulse" style={{ animationDelay: '600ms' }}></div>
        <div className="w-1.5 h-1.5 rounded-full bg-gray-300 animate-pulse" style={{ animationDelay: '750ms' }}></div>
      </div>
      <div className="flex gap-1">
        <div className="w-1.5 h-1.5 rounded-full bg-gray-300 animate-pulse" style={{ animationDelay: '900ms' }}></div>
        <div className="w-1.5 h-1.5 rounded-full bg-gray-300 animate-pulse" style={{ animationDelay: '1050ms' }}></div>
        <div className="w-1.5 h-1.5 rounded-full bg-gray-300 animate-pulse" style={{ animationDelay: '1200ms' }}></div>
      </div>
    </div>
  </div>
</div>

### "Working..." Status Bar

Verified from Notebook Agent interface - subtle status indicator:

```tsx
<div className="flex items-center gap-2 px-5 py-3 bg-gray-50 border border-gray-200 rounded-md">
  <div className="w-4 h-4 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"></div>
  <span className="text-sm text-gray-600">Working...</span>
</div>
```

**Colors:**
- Background: `#F9FAFB` (gray-50)
- Border: `#E5E7EB` (gray-200)
- Text: `#4B5563` (gray-600)
- Spinner: blue-500 on gray-300

**Example:**

<div className="p-4 bg-gray-50 rounded-lg">
  <div className="flex items-center gap-2 px-5 py-3 bg-gray-50 border border-gray-200 rounded-md">
    <div className="w-4 h-4 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"></div>
    <span className="text-sm text-gray-600">Working...</span>
  </div>
</div>

---

## Error States

### Input Error

Red border with focus ring:

```css
border-color: #EF4444; /* red-500 */
box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.2); /* red focus ring */
```

**Example:**

<div className="p-4 bg-gray-50 rounded-lg space-y-2">
  <input
    type="text"
    placeholder="Error state input"
    className="w-full px-4 py-2 border-2 border-red-500 rounded-md focus:outline-none focus:ring-4 focus:ring-red-500/20"
  />
  <p className="text-sm text-red-600">This field is required</p>
</div>

### Error Message

Error notification with icon:

```tsx
<div className="flex items-start gap-2 p-3 bg-red-50 border border-red-200 rounded-md">
  <AlertCircle className="w-4 h-4 text-red-500 mt-0.5" />
  <div>
    <p className="text-sm font-medium text-red-900">Error Title</p>
    <p className="text-sm text-red-700">Error message details...</p>
  </div>
</div>
```

**Example:**

<div className="p-4 bg-gray-50 rounded-lg">
  <div className="flex items-start gap-2 p-3 bg-red-50 border border-red-200 rounded-md">
    <svg className="w-4 h-4 text-red-500 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
    </svg>
    <div>
      <p className="text-sm font-medium text-red-900">Connection Failed</p>
      <p className="text-sm text-red-700">Unable to connect to database. Please check your credentials.</p>
    </div>
  </div>
</div>

---

## Empty States

### No Documents

Centered empty state with icon and CTA:

```tsx
<div className="flex flex-col items-center justify-center py-12 text-center">
  <FileIcon className="w-12 h-12 text-gray-300 mb-3" />
  <h3 className="text-lg font-semibold text-gray-900 mb-1">
    No documents yet
  </h3>
  <p className="text-sm text-gray-500 mb-4">
    Upload PDFs or Word documents to get started
  </p>
  <Button className="bg-gradient-to-r from-blue-500 to-blue-600">
    Upload Document
  </Button>
</div>
```

**Example:**

<div className="p-8 bg-gray-50 rounded-lg">
  <div className="flex flex-col items-center justify-center py-12 text-center">
    <svg className="w-12 h-12 text-gray-300 mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
    </svg>
    <h3 className="text-lg font-semibold text-gray-900 mb-1">No documents yet</h3>
    <p className="text-sm text-gray-500 mb-4">Upload PDFs or Word documents to get started</p>
    <button className="px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-md">
      Upload Document
    </button>
  </div>
</div>

### No Query Results

Simpler empty state for search results:

```tsx
<div className="flex flex-col items-center justify-center py-8 text-center">
  <DatabaseIcon className="w-12 h-12 text-gray-300 mb-3" />
  <h3 className="text-lg font-semibold text-gray-900 mb-1">
    No results found
  </h3>
  <p className="text-sm text-gray-500">
    Try adjusting your query or filters
  </p>
</div>
```

---

## Agent Interface Patterns

Verified patterns from Fall 2025 Agents demo screenshots.

### Message Bubbles

**User Input Bubble:**

```tsx
<div className="px-4 py-3 bg-gray-100 rounded-lg max-w-2xl">
  <p className="text-sm text-gray-500">
    What are the top 10 customers by revenue?
  </p>
</div>
```

**Colors:**
- Background: `#F3F4F6` (gray-100)
- Text: `#6B7280` (gray-500)
- Border radius: 8px (md)
- Padding: 12px 16px

**Example:**

<div className="p-4 bg-off-white rounded-lg space-y-3">
  <div className="px-4 py-3 bg-gray-100 rounded-lg max-w-2xl">
    <p className="text-sm text-gray-500">
      What are the top 10 customers by revenue?
    </p>
  </div>
</div>

**AI Response Card:**

```tsx
<div className="p-6 bg-white rounded-lg shadow-sm border border-gray-200 max-w-3xl">
  <p className="text-sm text-gray-800 leading-relaxed">
    Based on the analysis of your sales data, here are the top 10 customers...
  </p>
</div>
```

**Colors:**
- Background: `#FFFFFF` (white)
- Text: `#1F2937` (gray-800)
- Border: `#E5E7EB` (gray-200)
- Shadow: `0 1px 3px rgba(0, 0, 0, 0.05)` (very subtle)
- Border radius: 8px (md)

**Example:**

<div className="p-4 bg-off-white rounded-lg">
  <div className="p-6 bg-white rounded-lg shadow-sm border border-gray-200 max-w-3xl">
    <p className="text-sm text-gray-800 leading-relaxed">
      Based on the analysis of your sales data, here are the top 10 customers by total revenue in 2024.
    </p>
  </div>
</div>

### Code Cells (Notebook Agent)

Verified from Notebook Agent screenshots - purple SQL keywords, white background:

```tsx
<div className="p-4 bg-white rounded-md border border-gray-200 font-mono text-sm">
  <code>
    <span className="text-purple-500">SELECT</span>
    <span className="text-gray-800"> customer_name, </span>
    <span className="text-purple-500">SUM</span>
    <span className="text-gray-600">(</span>
    <span className="text-gray-800">revenue</span>
    <span className="text-gray-600">) </span>
    <span className="text-purple-500">AS</span>
    <span className="text-gray-800"> total_revenue</span>
    <br />
    <span className="text-purple-500">FROM</span>
    <span className="text-gray-800"> sales</span>
    <br />
    <span className="text-purple-500">WHERE</span>
    <span className="text-gray-800"> status </span>
    <span className="text-gray-600">= </span>
    <span className="text-blue-500">'active'</span>
    <br />
    <span className="text-purple-500">ORDER BY</span>
    <span className="text-gray-800"> total_revenue </span>
    <span className="text-purple-500">DESC</span>
  </code>
</div>
```

**Syntax Highlighting Colors:**
- **Keywords (SELECT, FROM, WHERE)**: `#8B5CF6` (purple-500) ⚠️ NOT red!
- **Functions (SUM, COUNT)**: `#8B5CF6` (purple-500)
- **Strings ('active')**: `#3B82F6` (blue-500)
- **Numbers**: `#1F2937` (gray-800)
- **Operators (=, AND)**: `#4B5563` (gray-600)
- **Comments**: `#6B7280` (gray-500)

**Cell Styling:**
- Background: `#FFFFFF` (white, NOT gray)
- Border: `#E5E7EB` (gray-200)
- Border radius: 6px (code cells use slightly smaller radius)
- Font: SF Mono, Monaco, monospace at 13px

**Example:**

<div className="p-4 bg-gray-50 rounded-lg">
  <div className="p-4 bg-white rounded-md border border-gray-200 font-mono text-sm">
    <code>
      <span className="text-purple-500">SELECT</span>
      <span className="text-gray-800"> customer_name, </span>
      <span className="text-purple-500">SUM</span>
      <span className="text-gray-600">(</span>
      <span className="text-gray-800">revenue</span>
      <span className="text-gray-600">) </span>
      <span className="text-purple-500">AS</span>
      <span className="text-gray-800"> total_revenue</span>
      <br />
      <span className="text-purple-500">FROM</span>
      <span className="text-gray-800"> sales</span>
      <br />
      <span className="text-purple-500">WHERE</span>
      <span className="text-gray-800"> status </span>
      <span className="text-gray-600">= </span>
      <span className="text-blue-500">'active'</span>
      <br />
      <span className="text-purple-500">ORDER BY</span>
      <span className="text-gray-800"> total_revenue </span>
      <span className="text-purple-500">DESC</span>
    </code>
  </div>
</div>

### Empty State Pattern

Verified from Threads interface - centered with subtle prompt:

```tsx
<div className="flex flex-col items-center justify-center py-16 text-center">
  <p className="text-sm text-gray-400 mb-2">Ask, edit, create...</p>
  <input
    type="text"
    placeholder="What would you like to know?"
    className="w-full max-w-2xl px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20"
  />
</div>
```

**Colors:**
- Prompt text: `#9CA3AF` (gray-400)
- Input border: `#E5E7EB` (gray-200)
- Focus ring: blue-500 at 20% opacity

**Example:**

<div className="p-8 bg-off-white rounded-lg">
  <div className="flex flex-col items-center justify-center py-16 text-center">
    <p className="text-sm text-gray-400 mb-2">Ask, edit, create...</p>
    <input
      type="text"
      placeholder="What would you like to know?"
      className="w-full max-w-2xl px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20"
    />
  </div>
</div>

---

## Disabled States

### Disabled Button

Grayed out with cursor change:

```css
background: #E5E7EB; /* gray-200 */
color: #9CA3AF; /* gray-400 */
cursor: not-allowed;
opacity: 0.6;
pointer-events: none;
```

**Example:**

<div className="p-4 bg-gray-50 rounded-lg flex gap-3">
  <button className="px-4 py-2 bg-blue-500 text-white rounded-md">
    Enabled
  </button>
  <button className="px-4 py-2 bg-gray-200 text-gray-400 rounded-md cursor-not-allowed opacity-60" disabled>
    Disabled
  </button>
</div>

### Disabled Input

Grayed background with no-drop cursor:

```css
background: #F9FAFB; /* gray-50 */
border-color: #E5E7EB; /* gray-200 */
color: #9CA3AF; /* gray-400 */
cursor: not-allowed;
pointer-events: none;
```

**Example:**

<div className="p-4 bg-gray-50 rounded-lg space-y-3">
  <input
    type="text"
    placeholder="Enabled input"
    className="w-full px-4 py-2 border border-gray-300 rounded-md"
  />
  <input
    type="text"
    placeholder="Disabled input"
    disabled
    className="w-full px-4 py-2 border border-gray-200 bg-gray-50 text-gray-400 rounded-md cursor-not-allowed"
  />
</div>

---

## Focus States

### Input Focus

Blue border with ring shadow:

```css
border-color: #4B7FFF; /* blue-500 */
outline: none;
box-shadow: 0 0 0 3px rgba(75, 127, 255, 0.2); /* blue-500 at 20% */
```

**Example:**

<div className="p-4 bg-gray-50 rounded-lg">
  <input
    type="text"
    placeholder="Click to focus"
    className="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20"
  />
</div>

### Button Focus (Keyboard Navigation)

Outline with offset for accessibility:

```css
outline: 2px solid #4B7FFF;
outline-offset: 2px;
```

**Example:**

<div className="p-4 bg-gray-50 rounded-lg">
  <button className="px-4 py-2 bg-blue-500 text-white rounded-md focus-visible:outline-2 focus-visible:outline-blue-500 focus-visible:outline-offset-2">
    Tab to focus
  </button>
</div>

### Accessible Focus (`:focus-visible`)

Show focus only for keyboard navigation, not mouse clicks:

```css
/* Reset browser default */
*:focus {
  outline: none;
}

/* Show focus ring only for keyboard navigation */
*:focus-visible {
  outline: 2px solid #4B7FFF;
  outline-offset: 2px;
}
```

---

## Best Practices

1. **Always provide visual feedback** for interactive elements (hover, active, focus states)
2. **Use transitions** for smooth state changes (200ms for shadows, 150ms for colors)
3. **Maintain accessibility** with proper focus indicators for keyboard navigation
4. **Keep loading states consistent** across the application
5. **Show meaningful empty states** with clear CTAs to guide users
6. **Use semantic colors** for error, success, and warning states

---

**Related**: [Colors Story](/story/design-system-colors--primary-blues) · [Typography Story](/story/design-system-typography--type-scale) · [Shadows Story](/story/design-system-shadows-elevation--shadow-scale)
